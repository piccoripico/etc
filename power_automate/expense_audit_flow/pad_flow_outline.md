# PAD フロー手順 (経費・精算チェック補助)

Power Automate for desktop で会計システムへ経費伝票を入力するための例です。

1. **入力受け取りと初期化**
   - クラウドフローから渡された `Amount`、`Purpose`、`SpendDate`、`Requester` を変数に格納。
   - 一時フォルダとログファイルを用意し、開始時刻を記録。

2. **会計システムへのログイン**
   - 既存の社内会計/経費精算アプリにサインインし、対象モジュール (経費登録) を開く。
   - 画面遷移が安定するまで待機し、セレクタを固定。

3. **申請内容の入力**
   - 金額、科目/目的、支払日を入力し、伝票を保存。
   - 伝票番号や受付番号が表示されたらテキストとして取得し、`VoucherNumber` などの変数に格納。

4. **結果の返却**
   - 成功時は `{ "status": "Success", "voucher": "12345", "message": "posted" }` 形式の JSON を文字列として作成し、`ResultJson` 変数に設定。
   - 失敗時は `{ "status": "Failed", "message": "理由" }` を作成し、スクリーンショットパスを含める。

5. **例外とリトライ**
   - 入力フィールドが見つからない場合は最大 3 回リトライ。失敗時は結果 JSON に詳細を含める。
   - 重大な例外時はアプリを再起動して再試行し、最後に `ResultJson` を返して終了。

クラウドフローの **Run a flow built with Power Automate for desktop** からこの PAD フローを呼び出し、戻り値の `ResultJson` を SharePoint リストや通知本文に利用してください。
